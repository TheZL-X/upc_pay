<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>管理界面</title>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <link rel="stylesheet" href="/css/my.css">

</head>
<body>

<div id="admin">

    <el-tabs v-model="activeName">


        <el-tab-pane label="新建缴费" name="first">

            <el-form ref="form" :rules="rules" :model="form" label-width="110px" style="width: 80%;margin: 0 auto">

                <el-form-item label="缴费名称" prop="name">
                    <el-input v-model="form.name"></el-input>
                </el-form-item>


                <el-form-item label="缴费类型" prop="type">
                    <el-select v-model="form.type" placeholder="请选择缴费类型" @change="changeType">
                        <el-option label="校内用户缴费" value="1"></el-option>
                        <el-option label="校外匿名用户" value="2"></el-option>
                    </el-select>
                </el-form-item>

                <div v-if="noschool">

                    <el-form-item label="参数1的名字" prop="p1name">

                        <el-col :span="11">
                            <el-input v-model="form.p1name"></el-input>
                        </el-col>
                        <el-col class="line" :span="2">&nbsp</el-col>

                        <el-col :span="11">
                            <el-form-item label="校验规则" prop="p1code">
                                <el-select v-model="form.p1code" placeholder="请选择校验规则">
                                    <el-option label="非空校验" value="0"></el-option>
                                    <el-option label="身份证校验" value="1"></el-option>
                                    <el-option label="手机号校验" value="2"></el-option>
                                    <el-option label="长度不超过50" value="3"></el-option>
                                </el-select>
                            </el-form-item>
                        </el-col>

                    </el-form-item>

                    <el-form-item label="参数2的名字" prop="p2name">

                        <el-col :span="11">
                            <el-input v-model="form.p2name"></el-input>
                        </el-col>
                        <el-col class="line" :span="2">&nbsp</el-col>

                        <el-col :span="11">

                            <el-form-item label="校验规则" prop="p2code">


                                <el-select v-model="form.p2code" placeholder="请选择规则">
                                    <el-option label="非空校验" value="0"></el-option>
                                    <el-option label="身份证校验" value="1"></el-option>
                                    <el-option label="手机号校验" value="2"></el-option>
                                </el-select>

                            </el-form-item>
                        </el-col>

                    </el-form-item>

                </div>

                <el-form-item label="是否定项">
                    <el-select v-model="form.isIndefine" placeholder="选择是否定项" @change="changeIndefine">
                        <el-option label="是" value="1"></el-option>
                        <el-option label="否" value="2"></el-option>
                    </el-select>
                </el-form-item>


                <div v-if="isIndefine">

                    <el-form-item label="添加选项"
                                  v-for="(option, index) in form.options"
                                  :key="option.key">

                        <el-col :span="8">
                            <el-form-item label="名字">
                                <el-input v-model="option.name"></el-input>
                            </el-form-item>
                        </el-col>


                        <el-col :span="8">
                            <el-form-item label="金额">
                                <el-input v-model="option.value"></el-input>
                            </el-form-item>
                        </el-col>

                        <el-col :span="2">
                            &nbsp
                        </el-col>

                        <el-col :span="6">
                            <el-button @click.prevent="removeOpt(option)">删除</el-button>
                        </el-col>

                    </el-form-item>

                    <el-form-item>
                        <el-button type="primary" @click="addOpt">添加选项</el-button>
                    </el-form-item>


                </div>


                <el-form-item label="采集票据信息">
                    <el-select v-model="form.isBill" placeholder="选择是否定项" @change="changeIsBill">
                        <el-option label="是" value="1"></el-option>
                        <el-option label="否" value="2"></el-option>
                    </el-select>
                </el-form-item>

                <el-form-item label="备注">
                    <el-input v-model="form.remark" type="textarea"></el-input>
                </el-form-item>



                <el-form-item label="subsysid" prop="subsysid">
                    <el-input v-model="form.subsysid"></el-input>
                </el-form-item>


                <el-form-item label="sysid" prop="sysid">
                    <el-input v-model="form.sysid"></el-input>
                </el-form-item>


                <el-form-item label="feeitemid" prop="feeitemid">
                    <el-input v-model="form.feeitemid"></el-input>
                </el-form-item>


                <el-form-item label="cert" prop="cert">
                    <el-input v-model="form.cert" type="textarea"></el-input>
                </el-form-item>


                <el-form-item>
                    <el-button type="primary" @click="create('form')">立即创建</el-button>
                    <el-button>取消</el-button>
                </el-form-item>
            </el-form>

        </el-tab-pane>


        <el-tab-pane label="管理缴费" name="second">

            <el-table :data="pays" highlight-current-row style="width: 50%;margin: 0 auto">


                <el-table-column prop="name" label="名称" width="300" sortable>
                </el-table-column>

                <el-table-column label="操作" width="300">
                    <template scope="scope">
                        <el-button size="small" @click="handleEdit(scope.$index, scope.row)">编辑</el-button>


                        <el-button type="danger" size="small" @click="deletPayment(scope.$index, scope.row)">删除</el-button>
                    </template>
                </el-table-column>
            </el-table>


        </el-tab-pane>


        <el-tab-pane label="添加管理员" name="thrid" v-if="sadmin">
            <div style="width: 50%;margin: 0 auto">
                <el-input v-model="adminid" placeholder="工号" style="width: 30%;float: left"></el-input>
                <el-input v-model="adminname" placeholder="姓名/部门" style="width: 30%;float: left;margin-left: 10px"></el-input>

                <el-button round style="float: left;margin-left: 10px" @click="addAdmin">添加</el-button>


            </div>

            <el-table :data="admins" highlight-current-row style="width: 50%;margin: 0 auto">


                <el-table-column prop="unit" label="姓名/部门" width="180" sortable>
                </el-table-column>
                <el-table-column prop="uname" label="工号" width="180" sortable>
                </el-table-column>

                <el-table-column label="操作" width="300">
                    <template scope="scope">
                        <el-button type="danger" size="small" @click="deletAdmin(scope.$index, scope.row)">删除</el-button>
                    </template>
                </el-table-column>


            </el-table>

        </el-tab-pane>


        <el-tab-pane label="维护税号" name="forth" v-if="sadmin">

                <el-upload
                        class="upload-demo"
                        drag
                        action="/uploadfile"
                        multiple
                        :on-success="fileUpload">
                    <i class="el-icon-upload"></i>
                    <div class="el-upload__text">将文件拖到此处，或<em>点击上传</em></div>

                </el-upload>

                <el-table :data="bills" highlight-current-row style="">


                    <el-table-column prop="zzUnit" label="单位名" width="200" sortable>
                    </el-table-column>

                    <el-table-column prop="taxCode" label="税号" width="200" sortable>
                    </el-table-column>

                    <el-table-column prop="zzAddress" label="地址" width="200" sortable>
                    </el-table-column>

                    <el-table-column prop="zzBnkName" label="银行名称" width="200" sortable>
                    </el-table-column>

                    <el-table-column prop="zzBank" label="银行卡号" width="200" sortable>
                    </el-table-column>

                    <el-table-column prop="zzTel" label="电话" width="100" sortable>
                    </el-table-column>


                    <el-table-column label="操作" width="300">
                        <template scope="scope">
                            <el-button type="danger" size="small" @click="deletBill(scope.$index, scope.row)">删除</el-button>
                        </template>
                    </el-table-column>
                </el-table>











        </el-tab-pane>



    </el-tabs>


    <el-dialog
            title="错误"
            :visible.sync="errdialog"
            width="30%">
        <span>{{ errmes }}}</span>
        <span slot="footer" class="dialog-footer">
    <el-button @click="errdialog = false">确 定</el-button>
  </span>
    </el-dialog>


    <el-dialog
            title="生成成功"
            :visible.sync="qrcode"
            width="30%"
    >
        <span> <img :src="qrcodeurl"> </span>
        <span slot="footer" class="dialog-footer">
    <el-button @click="qrcode = false">确 定</el-button>
  </span>
    </el-dialog>


    <!--编辑界面-->
    <el-dialog title="编辑" :visible.sync="editFormVisible" width="80%">


        <el-form ref="editform1" :rules="rules" :model="editform1" label-width="110px"
                 style="width: 80%;margin: 0 auto">

            <el-form-item label="缴费名称" prop="name">
                <el-input v-model="editform1.name"></el-input>
            </el-form-item>


            <el-form-item label="缴费类型" prop="type">
                <el-select v-model="editform1.type" placeholder="请选择缴费类型" @change="changeType">
                    <el-option label="校内用户缴费" value="1"></el-option>
                    <el-option label="校外匿名用户" value="2"></el-option>
                </el-select>
            </el-form-item>

            <div v-if="noschool">

                <el-form-item label="参数1的名字" prop="p1name">

                    <el-col :span="11">
                        <el-input v-model="editform1.p1name"></el-input>
                    </el-col>
                    <el-col class="line" :span="2">&nbsp</el-col>

                    <el-col :span="11">
                        <el-form-item label="校验规则" prop="p1code">
                            <el-select v-model="editform1.p1code" placeholder="请选择校验规则">
                                <el-option label="非空校验" value="0"></el-option>
                                <el-option label="身份证校验" value="1"></el-option>
                                <el-option label="手机号校验" value="2"></el-option>
                                <el-option label="长度不超过50" value="3"></el-option>
                            </el-select>
                        </el-form-item>
                    </el-col>

                </el-form-item>

                <el-form-item label="参数2的名字" prop="p2name">

                    <el-col :span="11">
                        <el-input v-model="editform1.p2name"></el-input>
                    </el-col>
                    <el-col class="line" :span="2">&nbsp</el-col>

                    <el-col :span="11">

                        <el-form-item label="校验规则" prop="p2code">


                            <el-select v-model="editform1.p2code" placeholder="请选择规则">
                                <el-option label="非空校验" value="0"></el-option>
                                <el-option label="身份证校验" value="1"></el-option>
                                <el-option label="手机号校验" value="2"></el-option>
                            </el-select>

                        </el-form-item>
                    </el-col>

                </el-form-item>

            </div>

            <el-form-item label="是否定项">
                <el-select v-model="editform1.isIndefine" placeholder="选择是否定项" @change="changeEditIndefine">
                    <el-option label="是" value="1"></el-option>
                    <el-option label="否" value="2"></el-option>
                </el-select>
            </el-form-item>

            <div v-if="editIsIndefine">

                <el-form-item label="添加选项"
                              v-for="(option, index) in editform1.options"
                              :key="option.mykey">

                    <el-col :span="8">
                        <el-form-item label="名字">
                            <el-input v-model="option.type"></el-input>
                        </el-form-item>
                    </el-col>


                    <el-col :span="8">
                        <el-form-item label="金额">
                            <el-input v-model="option.money"></el-input>
                        </el-form-item>
                    </el-col>

                    <el-col :span="2">
                        &nbsp
                    </el-col>

                    <el-col :span="6">
                        <el-button @click.prevent="removeOptEdit(option)">删除</el-button>
                    </el-col>

                </el-form-item>

                <el-form-item>
                    <el-button type="primary" @click="addEditOpt">添加选项</el-button>
                </el-form-item>


            </div>

            <el-form-item label="采集票据信息">
                <el-select v-model="editform1.isBill" placeholder="选择是否定项" @change="changeIsBill">
                    <el-option label="是" value="1"></el-option>
                    <el-option label="否" value="2"></el-option>
                </el-select>
            </el-form-item>

            <el-form-item label="备注">
                <el-input v-model="editform1.remark" type="textarea"></el-input>
            </el-form-item>


            <el-form-item label="subsysid" prop="subsysid">
                <el-input v-model="editform1.subsysid"></el-input>
            </el-form-item>


            <el-form-item label="sysid" prop="sysid">
                <el-input v-model="editform1.sysid"></el-input>
            </el-form-item>


            <el-form-item label="feeitemid" prop="feeitemid">
                <el-input v-model="editform1.feeitemid"></el-input>
            </el-form-item>


            <el-form-item label="cert" prop="cert">
                <el-input v-model="editform1.cert" type="textarea"></el-input>
            </el-form-item>


            <el-form-item>
                <img :src="editform1.editUrl">
            </el-form-item>


            <el-form-item>
                <el-button type="primary" @click="edit('editform1')">修改</el-button>
            </el-form-item>
        </el-form>


    </el-dialog>

</div>


<script src="/js/admin.js"></script>

</body>
</html>